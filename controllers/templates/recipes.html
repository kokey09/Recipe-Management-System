<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <title>Recipes</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/recipe.css') }}">
        <link rel="icon" href="{{ url_for('static', filename='recipes-img-table/recipes.png') }}" type="image/x-icon">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="{{ url_for('static', filename='js/popup.js') }}"></script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="{{ url_for('static', filename='js/search_recipe.js') }}"></script>

</head>
<body>
    {% extends 'base.html' %}

    {% block title %}Recipes{% endblock %}

    {% block content %}
    <fieldset>
        <legend><h1>Recipes</h1></legend>


        <!-- add recipe -->
        <div class="Overlay" id="Overlay" onclick="closePopup()"></div>
        <div class="Popup" id="Popup">
            <form method="POST" action="/add_recipe" enctype="multipart/form-data" class="form-recipe">
                <!-- Form for adding a new recipe -->
                <label for="recipe_name">Name:</label>
                <input type="text" id="recipe_name" name="recipe_name" class="name-form" required>

                <label for="instructions">Instructions:</label>
                <textarea id="instructions" name="instructions" rows="4" class="text-area-form" required></textarea>

                <label for="image_file">Image File:</label>
                <input type="file" id="image_file" name="image_file" accept="image/*" required>

                <button type="submit">Add Recipe</button>
            </form>

            <div onclick="closePopup()" class="close-btn">
                <i class='bx bx-x'></i>
            </div>
        </div>


            <!-- search container -->
                <div class="search-container">
                    <select id="columnSelector">
                        <option value="all">Search All</option>
                        <option value="recipe_id">ID</option>
                        <option value="name">Recipe Name</option>
                        <option value="instructions">Instructions</option>
                        <option value="account_id">Account ID</option>
                        <option value="account_username">Account Username</option>
                        <option value="status">Status</option>
                    </select>
                    <input type="text" id="search-Input-recipe" class="search-bar" placeholder="Search Recipe">
                    <button class="openPopup-btn" onclick="openPopup()"><i class='bx bx-plus-medical' title="add recipe"></i></button>
                    <a href="deleted_recipes">Recently Deleted</a>
                </div>


        <!-- tables -->
        <table class="recipes-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Recipe name</th>
                    <th>Image</th> <!-- Add a new column for the image -->
                    <th>Account ID </th>
                    <th>Account username </th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>

                {% for recipe in recipes %}
                <tr>
                    <td>{{ recipe.recipe_id }}</td>
                    <td>{{ recipe.name }}</td>
                    <td>
                        <img src="{{ recipe.image_url }}" alt="{{ recipe.name }} Image" style="width: 100px; height: 100px;" loading="lazy">
                    </td>
                    <td>{{recipe.account_id}}</td>
                    <td>{{ recipe.account.username }}</td>
                    <td>{{recipe.status}}</td>
                    <td>
                        <form method="POST" action="{{ url_for('delete_controller.delete_recipe_admin', id=recipe.recipe_id) }}" >
                             <button class="btn btn-danger" title="Delete Recipe" type="submit" onclick="return confirm('Are you sure you want to delete this Recipe?')"><i class='bx bxs-trash' ></i></button>
                            <a href="{{ url_for('dashboard_controller.recipe_preview', recipe_id=recipe.recipe_id) }}" class="btn btn-info"><i class='bx bxs-edit' title="preview and change status"></i></a>
                        </form>
                    </td>
                </tr>

                {% endfor %}

            </tbody>
        </table>
    </fieldset>
    {% endblock %}

</body>
</html>



